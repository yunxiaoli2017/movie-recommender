<!DOCTYPE html>
<html>
    <head>
    	<meta charset="utf-8">
        <title>Movie Recommender</title>
		<meta name="viewport"
			content="width=device-width, initial-scale=1">
		<script>
			// remove no-js and add 'js' to the HTML
			document.documentElement.className = document.documentElement.className.replace('no-js', 'js');
		</script>
	    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
    	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    	<link rel="stylesheet" href="css/rate.css">
    	<link href="https://fonts.googleapis.com/css2?family=PT+Sans+Narrow:wght@400;700&display=swap" rel="stylesheet">
    	
    	<!-- <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    	 -->
    </head>
    <body>
    	<!--
			Single SVG Reference
		-->
		<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display: none;">
			<symbol id="star"><g transform="scale(0.03125 0.03125)"><path d="M896 384l-313.5-40.781-134.5-279.219-134.531 279.219-313.469 40.781 230.469 208.875-59.469 303.063 277-148.812 277.062 148.812-59.562-303.063 230.5-208.875z" /></g></symbol>
			<symbol viewBox="0 0 18 18" id="no_rating"><g transform="scale(0.017578125 0.017578125)"><path d="M512 56.889c-251.362 0-455.111 203.749-455.111 455.111s203.749 455.111 455.111 455.111 455.111-203.749 455.111-455.111-203.749-455.111-455.111-455.111zM170.667 512c0-73.639 23.666-141.694 63.472-197.527l475.388 475.388c-55.833 39.806-123.888 63.472-197.527 63.472-188.222 0-341.333-153.111-341.333-341.333zM789.861 709.527l-475.388-475.388c55.833-39.806 123.888-63.472 197.527-63.472 188.222 0 341.333 153.111 341.333 341.333 0 73.639-23.666 141.694-63.472 197.527z" /></g></symbol>
		</svg>
		<div class="container">
		
	    	<header class="jumbotron pb-3">
			    <div class="container">
			      <h1>Welcome to <span>Movie Recommender!</span></h1>
			      <p>Movies picked for you are just a few clicks away!</p>
			      <p>Rate as many as you'd like, and submit to get recommendations.</p>
			      <hr>
			      <!-- <form action="/rate" method="GET">
			      	<input class="form-control" id="numMovies" type="number" name="numMovies" value="30" min="1" step="1" max="100">
			      	<label for="numMovies">Number of movies to show</label>
			      	<input type="submit" value="Unfamiliar? Re-generate" class="btn btn-md btn-success">
			      </form> -->
			      <form action="/rate" method="GET">
				      <div class="input-group mb-3">
				      	<div class="container px-0 w-100">
				      	  <p class="w-75">Unfamiliar? Choose how many movies to re-generate</p>
				      	</div>
			      	  	<input class="form-control col-3 col-lg-1" id="numMovies" type="number" name="numMovies" th:value="${numMovies} ?: 32" min="1" step="1" max="100">
						<div class="input-group-append">
						  <button class="btn btn-md btn-primary" type="submit">Show repicked results</button>
						</div>			
					  </div>
				  </form>
			      <!-- <p>
			        <a class="btn btn-primary btn-md" href="/rate">Unfamiliar? Re-generate</a>
			      </p> -->
			      <p>
			        <a href="/" class="btn btn-md btn-secondary go-back">Back to landing page</a>
			      </p>
			    </div>
			</header>
			
			<span th:text="${error} ?: ''"></span>
			<a th:class="${error} ? 'btn btn-outline-primary btn-md d-block' : 'd-none'" href="/rate">Back to rating page</a>
			
	        <form action="/recommendation" method="POST" th:object="${form}">
	        	<div align="right">
	        		<input type="submit" value="Submit Ratings" th:class="${error} ? 'd-none' : 'btn btn-success btn-md'" class="btn btn-md btn-success submit">
	        	</div>
		       	<div class="row equal">
		       		<div th:each="movie, itemStat : ${movies}" class="col-sm-6 col-md-4 col-lg-3 pb-5 pt-0 pl-0 pr-0">
	       				<div class="card h-100 mx-3">
	       					<img class="card-img-top p-0 h-70 poster" th:src="@{${movie.getPosterUrl()}}" th:alt="|Poster for ${movie.getTitle()}|">
		       				
	       					<div class="card-body">
		       					<div class="h-20 title">
		       						<h5 class="card-title h-100" th:text="${movie.getTitle()}"></h5>
		       					</div>
	           					<div class="h-20 genres">
		       						<p class="card-text h-100" th:text="${movie.getGenres()}"></p>
		       					</div>
		       					<hr>
								<div class="rating">
								<div class="inner-rating">
								<fieldset class="r-radios h-10">
									<input type="text" th:id="|${itemStat.index}th movie_id|" th:field="*{ratings[__${itemStat.index}__].movieId}">
									
									<!-- <input type="text" th:name="|${itemStat.index}th movie_id|" th:id="|${itemStat.index}th movie_id|" th:value="${movie.getId()}">
			 						-->
									<input type="radio" th:name="${movie.getId()}" th:id="|${movie.getId()} r_input_0|" th:field="*{ratings[__${itemStat.index}__].rating}" value="0">
									<label for="|${movie.getId()} r_input_0|" class="r-radio r-radio--none">
										<svg aria-hidden="true" focusable="false">
											<use xlink:href="#no_rating"/>
										</svg>
										<span role="presentation">No rating</span>
									</label>
									
									<input type="radio" th:name="${movie.getId()}" th:id="|${movie.getId()} r_input_1|" th:field="*{ratings[__${itemStat.index}__].rating}" value="1">
									<label for="|${movie.getId()} r_input_1|" class="r-radio">
										<svg aria-hidden="true" focusable="false">
											<use xlink:href="#star"/>
										</svg>
										<span role="presentation">1 Star</span>
									</label>
				
									<input type="radio" th:name="${movie.getId()}" th:id="|${movie.getId()} r_input_2|" th:field="*{ratings[__${itemStat.index}__].rating}" value="2">
									<label for="|${movie.getId()} r_input_2|" class="r-radio">
										<svg aria-hidden="true" focusable="false">
											<use xlink:href="#star"/>
										</svg>
										<span role="presentation">2 Stars</span>
									</label>
				
									<input type="radio" th:name="${movie.getId()}" th:id="|${movie.getId()} r_input_3|" th:field="*{ratings[__${itemStat.index}__].rating}" value="3">
									<label for="|${movie.getId()} r_input_3|" class="r-radio">
										<svg aria-hidden="true" focusable="false">
											<use xlink:href="#star"/>
										</svg>
										<span role="presentation">3 Stars</span>
									</label>
				
									<input type="radio" th:name="${movie.getId()}" th:id="|${movie.getId()} r_input_4|" th:field="*{ratings[__${itemStat.index}__].rating}" value="4">
									<label for="|${movie.getId()} r_input_4|" class="r-radio">
										<svg aria-hidden="true" focusable="false">
											<use xlink:href="#star"/>
										</svg>
										<span role="presentation">4 Stars</span>
									</label>
				
									<input type="radio" th:name="${movie.getId()}" th:id="|${movie.getId()} r_input_5|" th:field="*{ratings[__${itemStat.index}__].rating}" value="5">
									<label for="|${movie.getId()} r_input_5|" class="r-radio">
										<svg aria-hidden="true" focusable="false">
											<use xlink:href="#star"/>
										</svg>
										<span role="presentation">5 Stars</span>
									</label>
								</fieldset>
								<p>
								  <a th:href="@{${movie.getImdbUrl()}}" class="btn btn-sm btn-info">More Info on IMDB</a>
								</p>
								</div>
								</div>
		       				</div>
		       			</div>
	       			</div>
		       		<div class="container">
	        			<input type="submit" value="Submit Ratings" th:class="${error} ? 'd-none' : 'btn btn-success btn-md d-block'" class="btn btn-md btn-success submit d-block">
	        		</div>
		       </div>
	       </form>
        </div>
    </body>
</html>
